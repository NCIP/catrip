/*
 * VisualPanel.java
 *
 * Created on May 16, 2006, 2:21 PM
 */

package edu.duke.cabig.catrip.gui.panels;

import edu.duke.cabig.catrip.gui.components.CPanel;
import edu.duke.cabig.catrip.gui.query.DCQLGenerator;
import edu.duke.cabig.catrip.gui.wizard.MainFrame;
import javax.swing.*;
import org.apache.xmlbeans.XmlOptions;


/**
 *
 * @author  Sanjeev Agarwal
 */
public class VisualPanel extends CPanel {
    
    /** Creates new form VisualPanel */
    public VisualPanel() {
        initComponents();
    }
    
    public void setMainFrame(MainFrame mainFrame) {
        this.mainFrame = mainFrame;
        cQLDesignerPanel.setMainFrame(mainFrame);
        visualQueryDesignerPanel.setMainFrame(mainFrame);
    }
    
    
    public edu.duke.cabig.catrip.gui.panels.CQLDesignerPanel getCQLDesignerPanel() {
        return cQLDesignerPanel;
    }
    
    public edu.duke.cabig.catrip.gui.panels.VisualQueryDesignerPanel getVisualQueryDesignerPanel() {
        return visualQueryDesignerPanel;
    }
    
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        tabbedPane = new javax.swing.JTabbedPane();
        visualQueryDesignerPanel = new edu.duke.cabig.catrip.gui.panels.VisualQueryDesignerPanel();
        cQLDesignerPanel = new edu.duke.cabig.catrip.gui.panels.CQLDesignerPanel();

        setLayout(new java.awt.GridLayout(1, 0));

        tabbedPane.setTabLayoutPolicy(javax.swing.JTabbedPane.SCROLL_TAB_LAYOUT);
        tabbedPane.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                tabbedPaneStateChanged(evt);
            }
        });

        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("edu/duke/cabig/catrip/gui/resources/ResourceBundle"); // NOI18N
        tabbedPane.addTab(bundle.getString("VISUAL_PANEL_TAB_ONE"), visualQueryDesignerPanel); // NOI18N

        tabbedPane.addTab(bundle.getString("VISUAL_PANEL_TAB_TWO"), cQLDesignerPanel); // NOI18N

        add(tabbedPane);

    }// </editor-fold>//GEN-END:initComponents
    
    private void tabbedPaneStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_tabbedPaneStateChanged
        // parse the DCQL and show here...
        int id = tabbedPane.getSelectedIndex();
        if (id == 1){ // it is the dcql tab.. how show the DCQL..
            XmlOptions xmlOptions = new XmlOptions();
            xmlOptions.setSavePrettyPrint();
            xmlOptions.setSavePrettyPrintIndent(4);
            xmlOptions.setUseDefaultNamespace();
            getCQLDesignerPanel().setDcqlQueryText(DCQLGenerator.getDCQLText(xmlOptions));
        }
    }//GEN-LAST:event_tabbedPaneStateChanged
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private edu.duke.cabig.catrip.gui.panels.CQLDesignerPanel cQLDesignerPanel;
    private javax.swing.JTabbedPane tabbedPane;
    private edu.duke.cabig.catrip.gui.panels.VisualQueryDesignerPanel visualQueryDesignerPanel;
    // End of variables declaration//GEN-END:variables
    
    
    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                JFrame jf = new JFrame("Testing this panel");
                VisualPanel vp = new VisualPanel();
                VisualQueryDesignerPanel vv = new VisualQueryDesignerPanel();
                vp.getVisualQueryDesignerPanel().setDnDGraphView(new ListServicesPanel());
                jf.getContentPane().add(vp);
                jf.setBounds(10,10,400,200);
                jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                jf.setVisible(true);
            }
        });
    }
    
    
    
}
