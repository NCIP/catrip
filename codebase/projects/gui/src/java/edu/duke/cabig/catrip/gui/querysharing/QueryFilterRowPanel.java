/*L
 * Copyright Duke Comprehensive Cancer Center
 *
 * Distributed under the OSI-approved BSD 3-Clause License.
 * See http://ncip.github.com/catrip/LICENSE.txt for details.
 */

/*
 * QueryFilterRowPanel.java
 *
 * Created on April 14, 2007, 7:07 PM
 */

package edu.duke.cabig.catrip.gui.querysharing;

import edu.duke.cabig.catrip.gui.simplegui.CDEComboboxBean;
import gov.nih.nci.catrip.cagrid.catripquery.server.ClassDb;
import java.util.ArrayList;
import java.util.Random;


/**
 *
 * @author  Administrator
 */
public class QueryFilterRowPanel extends javax.swing.JPanel {
    
    
    private QueryServiceUI containterPanel;
    private ClassDb aClass = null;
    
    
    /** Creates new form QueryFilterRowPanel */
    public QueryFilterRowPanel() {
        initComponents();
    }
    
    
    public QueryFilterRowPanel(QueryServiceUI containterPanel_) {
        initComponents();
        containterPanel = containterPanel_;
    }
    
    public QueryFilterRowPanel(QueryServiceUI p, ArrayList listItems) {
        initComponents();
        containterPanel = p;
        // fill the combo with the classList..  this is of type CDEComboBoxBeans..
        for (int i = 0; i < listItems.size(); i++) {
            CDEComboboxBean cdeBean = (CDEComboboxBean) listItems.get(i);
            cbFilter.addItem(cdeBean);
        }
        
    }
    
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        delFilterButton = new javax.swing.JButton();
        cbFilter = new edu.duke.cabig.catrip.gui.components.SteppedComboBox();

        delFilterButton.setFont(new java.awt.Font("Tahoma", 1, 11));
        delFilterButton.setForeground(new java.awt.Color(255, 0, 0));
        delFilterButton.setText("X");
        delFilterButton.setIconTextGap(0);
        delFilterButton.setMargin(new java.awt.Insets(1, 1, 1, 1));
        delFilterButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                delFilterButtonActionPerformed(evt);
            }
        });

        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("edu/duke/cabig/catrip/gui/a11y/a11yBundle"); // NOI18N
        delFilterButton.getAccessibleContext().setAccessibleName(bundle.getString("edu.duke.cabig.catrip.gui.querysharing.QueryFilterRowPanel.delFilterButton.name")); // NOI18N
        delFilterButton.getAccessibleContext().setAccessibleDescription(bundle.getString("edu.duke.cabig.catrip.gui.querysharing.QueryFilterRowPanel.delFilterButton.description")); // NOI18N

        cbFilter.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbFilterActionPerformed(evt);
            }
        });

        cbFilter.getAccessibleContext().setAccessibleName(bundle.getString("edu.duke.cabig.catrip.gui.querysharing.QueryFilterRowPanel.cbFilter.name")); // NOI18N
        cbFilter.getAccessibleContext().setAccessibleDescription(bundle.getString("edu.duke.cabig.catrip.gui.querysharing.QueryFilterRowPanel.cbFilter.description")); // NOI18N

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .add(delFilterButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 24, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(cbFilter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 791, Short.MAX_VALUE)
                .add(20, 20, 20))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                .add(delFilterButton)
                .add(cbFilter, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
        );
    }// </editor-fold>//GEN-END:initComponents
    
    private void cbFilterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbFilterActionPerformed
        createSelectionObject();
    }//GEN-LAST:event_cbFilterActionPerformed
    
    private void delFilterButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_delFilterButtonActionPerformed
        removeFilter();
        System.out.println("delete");
    }//GEN-LAST:event_delFilterButtonActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private edu.duke.cabig.catrip.gui.components.SteppedComboBox cbFilter;
    private javax.swing.JButton delFilterButton;
    // End of variables declaration//GEN-END:variables
    
    
    
    protected void removeFilter() {
        containterPanel.removeFilter(this);
    }
    
    private void createSelectionObject(){
        Random generator = new Random();
        aClass = new ClassDb();
        aClass.setId(generator.nextInt());
        
        CDEComboboxBean cdeBean = (CDEComboboxBean)cbFilter.getSelectedItem();
        if (cdeBean!=null){
            aClass.setName(cdeBean.getClassBean().getFullyQualifiedName());
            System.out.println("Created class : " + aClass.getName());
            // if (!cdeBean.getAttributeBean().isNull()){ // set the attribute here..
            if (cdeBean.getAttributeBean() != null){ // set the attribute here..
                aClass.addAttribute(cdeBean.getAttributeBean().getAttributeName());
                System.out.println("Created attribute : " + cdeBean.getAttributeBean().getAttributeName());
            }
        }
        
    }
    public ClassDb getSelectedClass(){
        return aClass;
    }
    
    
    
    
    
    
    
}
